<p>알겠다. 요청한 대로 이미지 링크를 <code>&lt;img&gt;</code> 태그 형식으로 첨부하여 다시 정리한 내용을 보여준다.</p>
<hr />
<h2 id="3계층네트워크-계층의-역할">3계층(네트워크 계층)의 역할</h2>
<p>네트워크 계층은 LAN을 넘어 <strong>다른 네트워크와 통신하기 위한 계층</strong>이다.
이 계층은 크게 두 가지 주요 기능을 수행해서 물리 및 데이터링크 계층의 한계를 극복한다.</p>
<ol>
<li><strong>주소 지정 (Addressing):</strong> 논리적인 주소인 <strong>IP 주소</strong>를 사용해서 송신지와 수신지 대상을 정확하게 지정한다.</li>
<li><strong>라우팅 (Routing):</strong> 패킷이 출발지에서 목적지까지 이동할 최적의 경로를 결정해서 다른 네트워크와 통신할 수 있게 한다. 라우팅을 수행하는 대표적인 장비가 <strong>라우터</strong>이다.</li>
</ol>
<h3 id="물리데이터링크-계층만으로-lan을-넘어-통신하기-어려운-두-가지-이유">물리/데이터링크 계층만으로 LAN을 넘어 통신하기 어려운 두 가지 이유</h3>
<ul>
<li><strong>도달 경로 파악의 어려움:</strong> 데이터링크 계층의 MAC 주소는 같은 네트워크 내에서만 유효하다. 다른 네트워크로 가려면 라우터를 거쳐야 하는데, MAC 주소만으로는 라우터들이 어떻게 연결되어 있는지 파악하고 최적의 경로를 결정하기가 어렵다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/dafce741-f1a6-44a1-913a-fd4c276a0aff/image.png" width="500" /></li>
<li><strong>모든 호스트 위치 특정의 어려움:</strong> MAC 주소는 전 세계 모든 장치에 유일하게 할당되지만, 계층적 구조가 없어서 모든 호스트의 물리적 위치를 특정하기 어렵다. 반면, IP 주소는 네트워크 주소와 호스트 주소로 구성된 계층적 구조를 가지고 있어 라우팅을 효율적으로 할 수 있다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/1e3df653-3261-4a9b-920a-d1ad5d2299ad/image.png" width="500" />

</li>
</ul>
<p>결론적으로 MAC 주소(데이터링크 계층의 주소)와 IP 주소(네트워크 계층의 주소)는 함께 사용되고, 기본적으로 <strong>IP 주소를 먼저 활용해서 라우팅 경로를 결정</strong>한다.</p>
<hr />
<h2 id="ip-internet-protocol">IP (Internet Protocol)</h2>
<p>IP는 물리 계층과 데이터링크 계층의 한계를 극복하는 핵심 프로토콜이다. 현재 대부분 <strong>IPv4</strong>를 사용하고, RFC 791 문서에 명시된 공식적인 두 가지 기능이 있다.</p>
<ol>
<li><strong>주소 지정 (Addressing):</strong> IP 주소를 바탕으로 송수신 대상을 지정하는 기능이다.<ul>
<li><strong>IPv4 주소 구조:</strong> 4바이트(32비트)로 하나의 주소를 표현하고, 각 8비트(1 옥텟)를 <code>.</code>으로 구분해서 0부터 255까지의 10진수로 표기한다.</li>
<li>예시: <code>192.168.1.1</code></li>
</ul>
</li>
<li><strong>단편화 (Fragmentation):</strong> 전송하려는 패킷의 크기가 MTU(Maximum Transmission Unit)를 초과할 경우, 여러 개의 패킷으로 나누는 기능이다.<ul>
<li><strong>MTU:</strong> 한 번에 전송 가능한 IP 패킷의 최대 크기. 일반적인 MTU는 1500바이트다.</li>
<li><strong>재조합:</strong> 단편화된 패킷은 수신지에 도착하면 다시 원래의 패킷으로 재조합된다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/9fd9234d-143c-4964-8db6-f7861716ac63/image.png" width="500" /></li>
<li>IPv4 패킷은 데이터링크 계층의 <strong>프레임 페이로드</strong>에 실려 전송된다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/1479953c-fa45-4790-aba9-249ee2c20bfd/image.png" width="500" />

</li>
</ul>
</li>
</ol>
<h3 id="ipv4-패킷의-핵심-필드">IPv4 패킷의 핵심 필드</h3>
<img src="https://velog.velcdn.com/images/kdhun-0814/post/afb655b5-ed82-4c36-9add-b10cf7d12769/image.png" width="500" />

<ol>
<li><strong>식별자 (Identification):</strong> 단편화된 패킷들이 원래 어떤 메시지에서 분할되었는지 식별하는 데 사용되는 고유 번호이다.</li>
<li><strong>플래그 (Flags):</strong> 3개의 비트로 구성되어 있다.<ul>
<li>첫 번째 비트는 사용하지 않는다.</li>
<li><strong>DF 비트 (Don't Fragment):</strong> 단편화를 수행하지 말라는 표시이다.</li>
<li><strong>MF 비트 (More Fragments):</strong> 단편화된 패킷이 더 남아있음을 나타낸다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/2736357b-f8cd-433f-8bbc-b6a813cf6baa/image.png" width="500" /></li>
</ul>
</li>
<li><strong>단편화 오프셋 (Fragment Offset):</strong> 단편화된 조각들이 원래 데이터에서 몇 번째 위치에 해당하는지 알려준다. 수신자가 패킷들을 올바른 순서로 재조합하려면 이 정보가 필요하다.</li>
<li><strong>TTL (Time-to-Live):</strong> 패킷의 수명을 나타낸다. 무한 루프에 빠진 패킷이 네트워크에 계속 남아있는 걸 방지한다.<ul>
<li><strong>홉 (Hop):</strong> 패킷이 라우터나 호스트를 한 번 거치는 것을 의미한다. TTL은 홉을 지날 때마다 1씩 감소하고, 0이 되면 패킷을 폐기한다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/087f1e83-65ea-412d-805b-9eb554fb7dae/image.png" width="500" /></li>
</ul>
</li>
<li><strong>프로토콜 (Protocol):</strong> 상위 계층(전송 계층)에서 사용된 프로토콜이 무엇인지(예: TCP, UDP)를 나타내는 필드이다.</li>
<li><strong>송신지 IP 주소 (Source IP Address)</strong></li>
<li><strong>수신지 IP 주소 (Destination IP Address)</strong></li>
</ol>
<hr />
<h2 id="arp-address-resolution-protocol">ARP (Address Resolution Protocol)</h2>
<p>ARP는 IP 주소를 통해 <strong>MAC 주소</strong>를 알아내는 프로토콜이다. 동일한 네트워크 내에 있는 장치 간 통신 시 사용한다.</p>
<h3 id="arp-동작-과정">ARP 동작 과정</h3>
<p>호스트 A가 호스트 B의 IP 주소는 알지만 MAC 주소는 모르는 상황을 가정한다.
<img src="https://velog.velcdn.com/images/kdhun-0814/post/c2f3bcf7-223a-4f8c-89cc-d80d118b1d06/image.png" width="500" /></p>
<ol>
<li><strong>ARP 요청 (ARP Request):</strong> 호스트 A는 &quot;B의 IP 주소에 해당하는 MAC 주소를 아는 사람?&quot;이라는 <strong>브로드캐스트 메시지</strong>를 같은 네트워크에 있는 모든 장치에게 보낸다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/90434230-0677-45f1-92b0-8ad9f0308886/image.png" width="500" /></li>
<li><strong>ARP 응답 (ARP Reply):</strong> 브로드캐스트 메시지를 받은 장치 중 오직 호스트 B만 자신의 IP 주소와 일치하는 것을 확인한다. 호스트 B는 자신의 MAC 주소를 담은 <strong>유니캐스트 메시지</strong>를 호스트 A에게 직접 보낸다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/22d0dd0b-db37-4fe8-95eb-e1f293f91313/image.png" width="500" />
  * **ARP 패킷:** ARP 요청, ARP 응답 과정에서 송수신되는 패킷이다.
    <img src="https://velog.velcdn.com/images/kdhun-0814/post/d1a3486c-cd40-4c44-bdb8-f92e63009a6f/image.png" width="500" /></li>
<li><strong>ARP 테이블 갱신:</strong> ARP 요청-응답을 통해 알게 된 IP 주소와 MAC 주소의 연관 관계는 <strong>ARP 테이블</strong>에 저장된다. 한 번 테이블에 등록되면, 일정 시간 동안은 ARP 요청을 다시 보낼 필요 없이 MAC 주소를 바로 사용한다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/c84bc740-3c91-46e2-9e81-5afcd5fce6c5/image.png" width="500" />

</li>
</ol>
<h3 id="다른-네트워크에-속한-경우의-arp-동작">다른 네트워크에 속한 경우의 ARP 동작</h3>
<p>다른 네트워크에 있는 호스트와 통신할 때는 ARP가 라우터와 호스트 간의 연결을 위해 순차적으로 동작한다.</p>
<ol>
<li>호스트 A는 ARP 요청-응답 과정을 통해 라우터 A의 MAC 주소를 알아내고, 패킷을 라우터 A로 보낸다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/30a02317-1004-49d9-ac58-27bfefd813f7/image.png" width="500" /></li>
<li>라우터 A는 다음 라우터(라우터 B)로 패킷을 보내기 위해 라우터 B의 MAC 주소를 ARP로 알아낸다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/0705ec66-dbd8-489b-884d-882a2ec71097/image.png" width="500" /></li>
<li>마지막으로 라우터 B는 최종 목적지인 호스트 B의 MAC 주소를 ARP로 알아내고 패킷을 전달한다.<img src="https://velog.velcdn.com/images/kdhun-0814/post/d55cd143-4b72-4113-98bc-2a0980540913/image.png" width="500" /></li>
</ol>